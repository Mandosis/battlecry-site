/*! battlecry-site 2016-05-10 */
var app=angular.module("battlecryApp",["ngRoute","angular-loading-bar"]);app.controller("HeadController",["HeadService",function(a){var b=this;b.tags=a.tags}]),app.controller("AppController",["UserService",function(a){var b=this;b.user=a.user,a.isAuthenticated(function(a,b){console.log(a)})}]),app.controller("HomeController",["HeadService","UserService","cfpLoadingBar","$timeout",function(a,b,c,d){var e=this;a.title("Home"),b.isAuthenticated(function(){}),e.startLoad=function(){c.start()},e.completeLoad=function(){c.complete()},e.startLoad(),e.fakeIntro=!0,d(function(){e.completeLoad(),e.fakeIntro=!1},1250)}]),app.controller("ErrorController",["HeadService","UserService","cfpLoadingBar","$timeout",function(a,b,c,d){var e=this;a.title("404"),b.isAuthenticated(function(){}),e.startLoad=function(){c.start()},e.completeLoad=function(){c.complete()},e.startLoad(),e.fakeIntro=!0,d(function(){e.completeLoad(),e.fakeIntro=!1},1250)}]),app.controller("LoginController",["HeadService","cfpLoadingBar","$timeout","UserService","$routeParams","$location",function(a,b,c,d,e,f){var g=this;g.username="",g.password="",g.error="",a.title("Login"),d.isAuthenticated(function(){}),g.login=function(){d.login(g.username,g.password,function(a){a.success?(f.path("/"),d.isAuthenticated(function(a,b){console.log(a)})):g.error="Username or password incorrect"})},g.startLoad=function(){b.start()},g.completeLoad=function(){b.complete()},g.startLoad(),g.fakeIntro=!0,c(function(){g.completeLoad(),g.fakeIntro=!1},1250)}]),app.controller("LogoutController",["HeadService","cfpLoadingBar","$timeout","UserService","$routeParams","$location",function(a,b,c,d,e,f){var g=this;a.title("Logout"),d.isAuthenticated(function(){}),d.logout(function(){d.isAuthenticated(function(a,b){console.log(a),f.path("/")})}),g.startLoad=function(){b.start()},g.completeLoad=function(){b.complete()},g.startLoad(),g.fakeIntro=!0,c(function(){g.completeLoad(),g.fakeIntro=!1},1250)}]),app.controller("ProfileController",["HeadService","UserService","$http","cfpLoadingBar","$timeout","ProfileService","$routeParams",function(a,b,c,d,e,f,g){var h=this;h.data=f.data,a.title(g.username),b.isAuthenticated(function(){}),f.profile(g.username),f.stats(g.username),h.startLoad=function(){d.start()},h.completeLoad=function(){d.complete()},h.startLoad(),h.fakeIntro=!0,e(function(){h.completeLoad(),h.fakeIntro=!1},1250)}]),app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/app/view/home",controller:"HomeController",controllerAs:"home"}).when("/community",{templateUrl:"/app/view/community",controller:"CommunityController",controllerAs:"community"}).when("/player/:username",{templateUrl:function(a){return"/app/view/profile/"+a.username},controller:"ProfileController",controllerAs:"profile"}).when("/login",{templateUrl:"/app/view/login",controller:"LoginController",controllerAs:"login"}).when("/logout",{templateUrl:"/app/view/logout",controller:"LogoutController",controllerAs:"logout"}).otherwise({templateUrl:"/app/view/404",controller:"ErrorController",controllerAs:"error"}),b.html5Mode(!0)}]),app.factory("HeadService",function(){var a={},b=function(b){a.title=b+" | Battlecry"};return{tags:a,title:b}});var partials={};app.factory("TemplateService",["$http",function(a){var b=function(b){console.log(b),a.get("/app/partials/profile").then(function(a){partials.profile=a.data})};return{partials:partials,profile:b}}]),app.factory("ProfileService",["$http",function(a){var b={},c=function(c){a.get("/app/v1/players/"+c).then(function(a){b.account=a.data})},d=function(c){a.get("/app/v1/players/"+c+"/stats").then(function(a){b.stats=a.data})};return{data:b,profile:c,stats:d}}]),app.factory("UserService",["$http",function(a){var b={},c=function(b,c,d){var e={username:b,password:c};a.post("/app/v1/login/",e).then(function(a){d(a.data)},function(a){d({success:!1,message:"Username or password incorrect"})})},d=function(c){a.get("/app/v1/logout").then(function(a){b.data={},c()})},e=function(c){a.get("/app/v1/auth").then(function(a){a.data.success?(b.data=a.data.user,c(!0,a.data)):c(!1)})};return{user:b,login:c,logout:d,isAuthenticated:e}}]);